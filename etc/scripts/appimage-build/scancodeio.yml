app: scancodeio

ingredients:
  dist: focal
  sources:
    - deb http://us.archive.ubuntu.com/ubuntu/ focal main universe
    - deb http://us.archive.ubuntu.com/ubuntu/ focal-updates main universe
    - deb http://us.archive.ubuntu.com/ubuntu/ focal-security main universe
  packages:
    - python3
    - python3-dev
    - python3-pip
    - python3-setuptools
    - python-is-python3
    - bzip2
    - xz-utils
    - zlib1g
    - libxml2-dev
    - libxslt1-dev
    - libpopt0
    - libc6

script:
  - env
  - mkdir -p usr/share/scancodeio
  - wget -c https://github.com/nexB/scancode.io/archive/refs/heads/update-scancode.tar.gz -O - | tar xz --directory=./usr/share/scancodeio --strip-components=1
  - make -f ../../Makefile envfile
  - mv .env ./usr/share/scancodeio/.env
  - cp ../../resources/python.png .
  - ./usr/bin/python3.8 -m pip install ./usr/share/scancodeio -t usr/lib/python3.8/dist-packages/ --system
  - ./usr/bin/python3.8 -m pip install --upgrade https://github.com/nexB/python-inspector/archive/refs/heads/update-cache-location.zip -t usr/lib/python3.8/dist-packages/ --system
  - ./usr/bin/python3.8 -m pip install --upgrade packaging==21.3 -t usr/lib/python3.8/dist-packages/ --system
  - cp ../../resources/scancodeio.desktop .
  - cp ../../resources/scancodeio.desktop usr/share/applications/scancodeio.desktop
